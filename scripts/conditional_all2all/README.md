# Conditional Backdoor Scripts - Quick Start Guide

## Overview
This directory contains **1,176 experiment scripts** for conditional backdoor attacks on 21 datasets.

- **Attack Type**: all2all (class-conditional, targeted backdoors)
- **Models**: cpatchtst, citst, ccnn, ccnn_cae
- **Methods**: basic, inputaware, pureinputaware, marksman, diversity, frequency, ultimate
- **Hyperparameters**: 2 configurations per method

## Quick Start

### Run a Single Experiment
```bash
# Example: Basic method with cpatchtst on BasicMotions
cd /home/meo16/TimeSeries-Backdoor
bash scripts/conditional_all2all/dataset_BasicMotions.sh
```

### Run All Experiments for One Dataset
```bash
# All experiments for JapaneseVowels (56 experiments)
bash scripts/conditional_all2all/dataset_JapaneseVowels.sh
```

### Run All Experiments for One Model
```bash
# All experiments with cpatchtst (294 experiments)
bash scripts/conditional_all2all/model_cpatchtst_all_methods.sh
```

### Run All Experiments for One Method
```bash
# All inputaware experiments with citst (42 experiments)
bash scripts/conditional_all2all/method_inputaware_citst.sh
```

### Run Everything
```bash
# All 1,176 experiments (may take days!)
bash scripts/conditional_all2all/master_all_experiments.sh
```

## File Structure

### By Dataset (21 files)
Each dataset gets all combinations of 4 models × 7 methods × 2 configs = 56 experiments
- `dataset_BasicMotions.sh`
- `dataset_JapaneseVowels.sh`
- `dataset_Cricket.sh`
- ... (18 more)

### By Model (4 files)
Each model runs all datasets × all methods × 2 configs = 294 experiments
- `model_cpatchtst_all_methods.sh`
- `model_citst_all_methods.sh`
- `model_ccnn_all_methods.sh`
- `model_ccnn_cae_all_methods.sh`

### By Method (28 files = 7 methods × 4 models)
Each file runs all datasets × 2 configs = 42 experiments
- `method_basic_cpatchtst.sh`
- `method_inputaware_citst.sh`
- `method_marksman_ccnn.sh`
- ... (25 more)

## Hyperparameter Configurations

### basic
- **default**: clip_ratio=0.1
- **high_clip**: clip_ratio=0.2

### inputaware
- **default**: p_attack=0.5, p_cross=0.1, lambda_cross=1.0
- **aggressive**: p_attack=0.7, p_cross=0.15, lambda_cross=2.0

### pureinputaware
- **default**: p_attack=0.5
- **high_attack**: p_attack=0.7

### marksman
- **default**: alpha=0.5, beta=0.0, update_T=1
- **high_alpha**: alpha=0.7, beta=0.001, update_T=2

### diversity
- **default**: div_reg=1.0, poison_ratio=0.1
- **high_div**: div_reg=2.0, poison_ratio=0.2

### frequency
- **default**: lambda_freq=1.0, freq_lambda=0.05
- **high_freq**: lambda_freq=2.0, freq_lambda=0.1

### ultimate
- **balanced**: all lambdas=1.0, p_attack=0.5, p_cross=0.1
- **aggressive**: all lambdas=2.0, p_attack=0.7, p_cross=0.15

## Datasets

| Dataset | Seq | Vars | Classes | Experiments |
|---------|-----|------|---------|-------------|
| BasicMotions | 100 | 6 | 4 | 56 |
| JapaneseVowels | 26 | 12 | 9 | 56 |
| Cricket | 1197 | 6 | 12 | 56 |
| Heartbeat | 405 | 61 | 2 | 56 |
| ElectricDevices | 96 | 1 | 7 | 56 |
| ... | ... | ... | ... | ... |

*See CONDITIONAL_SUMMARY.md for full list*

## Recommended Workflow

### 1. Test Small Dataset First
```bash
# BirdChicken: only 20 train samples, fast to run
bash scripts/conditional_all2all/dataset_BirdChicken.sh
```

### 2. Compare Methods on One Dataset
```bash
# Compare all methods on BasicMotions
bash scripts/conditional_all2all/dataset_BasicMotions.sh
```

### 3. Test One Method Across Datasets
```bash
# Test basic method with cpatchtst across all datasets
bash scripts/conditional_all2all/method_basic_cpatchtst.sh
```

### 4. Production Run
Select specific combinations based on initial results.

## Expected Runtime

Approximate times (on single GPU):
- **Small dataset** (e.g., BirdChicken, 20 samples): ~5-10 min per experiment
- **Medium dataset** (e.g., BasicMotions, 40 samples): ~10-20 min per experiment  
- **Large dataset** (e.g., ElectricDevices, 8926 samples): ~1-3 hours per experiment

**Total estimated time for all 1,176 experiments**: 500-1000 GPU hours

## Tips

1. **Parallel Execution**: Run different datasets/models in parallel on separate GPUs
2. **Monitoring**: Use `watch -n 1 nvidia-smi` to monitor GPU usage
3. **Logging**: Redirect output to log files for later analysis
   ```bash
   bash dataset_BasicMotions.sh > logs/basicmotions.log 2>&1
   ```
4. **Resume**: Scripts are organized so you can comment out completed experiments

## Generated By
Script: `scripts/generate_conditional_scripts.py`
Date: 2026-01-04
Config: `dataset_info_subset.csv`
